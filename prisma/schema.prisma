generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model SeUser {
  id            Int      @id @default(autoincrement())
  name          String
  password      String
  salePointCode Int
  systemId      Int      @map("system_id")
  email         String   @unique
  ebSystem      EbSystem @relation(fields: [systemId], references: [id])

  @@map("se_user")
}

model GeConstantGroup {
  codeGroup   String @id @map("code_group")
  description String

  @@map("ge_constant_group")
}

model GeConstant {
  code        String
  codeGroup   String   @map("code_group")
  description String
  value       String?
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  observation String?

  @@id([code, codeGroup])
  @@map("ge_constant")
}

model EbSystem {
  id           Int          @id @default(autoincrement())
  systemCode   String       @map("system_code")
  nit          BigInt
  business     String       @db.VarChar(100)
  modalityCode Int          @map("modality_code")
  createdAt    DateTime     @default(now()) @map("created_at")
  updatedAt    DateTime     @updatedAt @map("updated_at")
  status       Status       @default(ACTIVE)
  image        Bytes?
  sucursals    EbSucursal[]
  tokens       EbToken[]
  users        SeUser[]

  @@unique([systemCode, nit])
  @@map("eb_system")
}

model EbToken {
  id           Int      @id @default(autoincrement())
  token        String
  startAt      DateTime @map("start_at")
  expirationAt DateTime @map("expiration_at")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")
  systemId     Int      @map("system_id")
  system       EbSystem @relation(fields: [systemId], references: [id])

  @@map("eb_token")
}

model EbSucursal {
  id           Int           @id @default(autoincrement())
  sucursalCode Int           @map("sucursal_code")
  description  String        @db.VarChar(100)
  modalityCode Int           @map("modality_code")
  address      String?       @db.VarChar(200)
  phone        String?       @db.VarChar(20)
  municipality String?       @db.VarChar(50)
  city         String?       @db.VarChar(500)
  status       Status        @default(ACTIVE)
  createdAt    DateTime      @default(now()) @map("created_at")
  updatedAt    DateTime      @updatedAt @map("updated_at")
  systemId     Int           @map("system_id")
  sale_point   EbSalePoint[]
  system       EbSystem      @relation(fields: [systemId], references: [id])

  @@map("eb_sucursal")
}

model EbSalePoint {
  id            Int        @id @default(autoincrement())
  salePointCode Int        @map("sale_point_code")
  description   String     @db.VarChar(100)
  modalityCode  Int        @map("modality_code")
  typeSalePoint Int        @map("type_sale_point")
  status        Status     @default(ACTIVE)
  createdAt     DateTime   @default(now()) @map("created_at")
  updatedAt     DateTime   @updatedAt @map("updated_at")
  sucursalId    Int        @map("sucursal_id")
  sucursal      EbSucursal @relation(fields: [sucursalId], references: [id])

  @@map("eb_sale_point")
}

model EbCuis {
  cuis          String   @id @db.VarChar(100)
  expirationAt  DateTime @map("expiration_at")
  systemCode    String   @map("system_code") @db.VarChar(100)
  nit           BigInt
  sucursalCode  Int      @map("sucursal_code")
  salePointCode Int      @map("sale_point_code")
  status        Status   @default(ACTIVE)
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  @@map("eb_cuis")
}

model EbCufd {
  cufd          String   @id @db.VarChar(100)
  expirationAt  DateTime @map("expiration_at")
  systemCode    String   @map("system_code") @db.VarChar(100)
  nit           BigInt
  sucursalCode  Int      @map("sucursal_code")
  salePointCode Int      @map("sale_point_code")
  controlCode   String   @map("control_code") @db.VarChar(50)
  status        Status   @default(ACTIVE)
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  @@map("eb_cufd")
}

model SynDateHour {
  dateSystem DateTime @map("date_system")
  dateSin    DateTime @map("date_sin")
  systemCode String   @map("system_code") @db.VarChar(100)
  nit        BigInt

  @@id([dateSystem, systemCode, nit])
  @@map("syn_date_hour")
}

model SynCatalogue {
  code        String   @db.VarChar(50)
  type        String   @db.VarChar(50)
  systemCode  String   @map("system_code") @db.VarChar(100)
  nit         BigInt
  description String   @db.VarChar(200)
  createdAt   DateTime @default(now()) @map("created_at")
  visible     Status   @default(ACTIVE)

  @@id([code, type, systemCode, nit])
  @@map("syn_catalogue")
}

model EbHomologationCatalogue {
  code            String    @db.VarChar(50)
  type            String    @db.VarChar(50)
  systemCode      String    @map("system_code") @db.VarChar(100)
  nit             BigInt
  codeHomologated String    @map("code_homologated") @db.VarChar(50)
  description     String?   @db.VarChar(200)
  createdAt       DateTime  @default(now()) @map("created_at")
  validateType    DataType? @map("validate_type")

  @@id([code, type, systemCode, nit])
  @@map("eb_homologation_catalogue")
}

model SynInvoiceLegend {
  activityCode String   @map("activity_code") @db.VarChar(50)
  description  String   @db.VarChar(300)
  systemCode   String   @map("system_code")
  nit          BigInt
  createdAt    DateTime @default(now()) @map("created_at")

  @@id([activityCode, description, systemCode, nit])
  @@map("syn_invoice_legend")
}

model SynProductService {
  productCode  String   @map("product_code") @db.VarChar(50)
  systemCode   String   @map("system_code") @db.VarChar(100)
  nit          BigInt
  activityCode String   @map("activity_code") @db.VarChar(50)
  description  String   @db.VarChar(500)
  createdAt    DateTime @default(now()) @map("created_at")

  @@id([productCode, systemCode, nit, activityCode])
  @@map("syn_product_service")
}

model EbHomologationProductService {
  productCode     String   @map("product_code") @db.VarChar(50)
  systemCode      String   @map("system_code") @db.VarChar(100)
  nit             BigInt
  activityCode    String   @map("activity_code") @db.VarChar(50)
  codeHomologated String   @map("code_homologated") @db.VarChar(50)
  description     String?  @db.VarChar(200)
  createdAt       DateTime @default(now()) @map("created_at")

  @@id([productCode, systemCode, nit, activityCode])
  @@map("eb_homologation_product_service")
}

model SynActivity {
  activityCode       String   @map("activity_code") @db.VarChar(50)
  systemCode         String   @map("system_code") @db.VarChar(100)
  nit                BigInt
  sectorDocumentCode String   @map("sector_document_code") @db.VarChar(10)
  activityType       String   @map("activity_type") @db.VarChar(30)
  description        String?  @db.VarChar(200)
  createdAt          DateTime @default(now()) @map("created_at")

  @@id([activityCode, systemCode, nit, sectorDocumentCode, activityType])
  @@map("syn_activity")
}

model ebPackageBill {
  packageId          BigInt       @id @default(autoincrement()) @map("package_id")
  cufd               String?      @db.VarChar(100)
  billStatusId       Int          @default(0) @map("bill_status_id")
  nitEmitter         BigInt       @map("nit_emitter")
  sucursalCode       Int          @map("sucursal_code")
  salePointCode      Int          @map("sale_point_code")
  emitteType         Int          @map("emitte_type")
  modalityCode       Int          @map("modality_code")
  sectorDocumentCode String       @map("sector_document_code") @db.VarChar(2)
  documentTaxCode    Int          @map("document_tax_code")
  receptionCode      String?      @map("recception_code") @db.VarChar(100)
  statusCode         String?      @map("status_code") @db.VarChar(10)
  statusDescription  String?      @map("status_description") @db.VarChar(200)
  eventCode          String?      @map("event_code") @db.VarChar(50)
  cafc               String?      @db.VarChar(50)
  systemCode         String       @map("system_code") @db.VarChar(100)
  createdAt          DateTime     @default(now()) @map("created_at")
  bills              ebBill[]
  billStatus         ebBillStatus @relation(fields: [billStatusId], references: [billStatusId])

  @@map("eb_package_bill")
}

model ebPackageFile {
  packageId BigInt   @id @map("package_id")
  file      Bytes?
  createdAt DateTime @default(now()) @map("created_at")

  @@map("eb_package_file")
}

model ebBillStatus {
  billStatusId Int             @id @map("bill_status_id")
  description  String          @db.VarChar(30)
  ebBills      ebBill[]
  packages     ebPackageBill[]

  @@map("eb_bill_status")
}

model ebBill {
  billId                       BigInt         @id @default(autoincrement()) @map("bill_id")
  systemCode                   String         @map("system_code") @db.VarChar(100)
  cuf                          String?        @unique @db.VarChar(100)
  cufd                         String?        @db.VarChar(100)
  billNumber                   Int            @map("bill_number")
  nitEmitter                   BigInt         @map("nit_emitter")
  sucursalCode                 Int            @map("sucursal_code")
  salePointCode                Int            @map("sale_point_code")
  dateEmitte                   DateTime?      @map("date_emitte")
  billName                     String         @map("bill_name") @db.VarChar(100)
  documentType                 String         @map("document_type") @db.VarChar(50)
  billDocument                 String         @map("bill_document") @db.VarChar(20)
  billComplement               String?        @map("bill_complement") @db.VarChar(5)
  address                      String?        @db.VarChar(300)
  clientCode                   String         @map("client_code") @db.VarChar(50)
  paymentMethod                String         @map("payment_method") @db.VarChar(50)
  cardNumber                   String?        @map("card_number") @db.VarChar(20)
  amount                       Float
  amountIva                    Float          @map("amount_iva")
  amountDiscount               Float?         @map("amount_discount")
  amountGiftCard               Float?         @map("amount_gift_card")
  coinCode                     String         @map("coin_code") @db.VarChar(50)
  exchangeRate                 Float          @map("exchange_rate")
  legend                       String?        @db.VarChar(300)
  sectorDocumentCode           String         @map("sector_document_code") @db.VarChar(2)
  modalityCode                 Int            @map("modality_code")
  emitteType                   Int            @map("emitte_type")
  documentTaxCode              Int            @map("document_tax_code")
  exceptionDocument            Int?           @map("exception_document")
  billExternalCode             String         @map("bill_external_code") @db.VarChar(50)
  billedPeriod                 String?        @map("billed_period") @db.VarChar(30)
  billStatusId                 Int            @default(0) @map("bill_status")
  packageId                    BigInt         @map("package_id")
  billNameEmitter              String         @map("bill_name_emitter") @db.VarChar(100)
  municipality                 String         @db.VarChar(100)
  receptionCode                String?        @map("recception_code") @db.VarChar(100)
  statusCode                   String?        @map("status_code") @db.VarChar(10)
  statusDescription            String?        @map("status_description") @db.VarChar(200)
  reasonAnnulationCode         String?        @map("reason_annulation_code") @db.VarChar(5)
  cafc                         String?        @db.VarChar(50)
  email                        String?        @db.VarChar(50)
  qr                           String?        @db.VarChar(200)
  note                         String?        @db.VarChar(200)
  eventId                      Int?           @map("event_id")
  createdAt                    DateTime       @default(now()) @map("created_at")
  addressBuyer                 String?        @map("address_buyer") @db.VarChar(200)
  placeDestination             String?        @map("place_destination") @db.VarChar(200)
  codeCountry                  String?        @map("code_country") @db.VarChar(50)
  additionalInformation        String?        @map("additional_information") @db.VarChar(100)
  billNumberRef                Int?           @map("bill_number_ref")
  cufRef                       String?        @map("cuf_ref") @db.VarChar(100)
  dateEmitteRef                DateTime?      @map("date_emitte_ref")
  billIdRef                    BigInt?        @map("bill_id_ref")
  amountTotalOriginal          Float?         @map("amount_total_original")
  amountTotalReturned          Float?         @map("amount_total_returned")
  amountDiscountCreditDebit    Float?         @map("amount_discount_credit_debit")
  amountEffectiveCreditDebit   Float?         @map("amount_effective_credit_debit")
  user                         String?        @db.VarChar(50)
  beneficiarioLey1886          String?        @map("beneficiario_ley_1886") @db.VarChar(50)
  meterNumber                  String?        @map("meter_number") @db.VarChar(50)
  montoDescuentoTarifaDignidad Float?         @map("monto_desc_tarifa_dig")
  montoDescuentoLey1886        Float?         @map("monto_descuento_ley_1886")
  otrasTasas                   Float?         @map("otras_tasas")
  tasaAlumbrado                Float?         @map("tasa_alumbrado")
  tasaAseo                     Float?         @map("tasa_aseo")
  studentName                  String?        @map("student_name") @db.VarChar(100)
  consumptionPeriod            String?        @map("consumption_period") @db.VarChar(10)
  month                        String?        @map("month") @db.VarChar(2)
  year                         String?        @map("year") @db.VarChar(5)
  annulled                     String?        @map("annulled") @db.VarChar(2)
  billStatus                   ebBillStatus   @relation(fields: [billStatusId], references: [billStatusId])
  package                      ebPackageBill  @relation(fields: [packageId], references: [packageId])
  details                      ebBillDetail[]

  @@map("eb_bill")
}

model ebBillDetail {
  billId                BigInt  @map("bill_id")
  economicActivity      String  @map("economic_activity")
  productCodeSin        String  @map("product_code_sin")
  productCode           String  @map("product_code")
  description           String
  quantity              Int
  measureCode           String  @map("measure_code")
  measure               String?
  unitPrice             Float   @map("unit_price")
  amountDiscount        Float?  @map("amount_discount")
  subtotal              Float
  order                 Int
  serieNumber           String? @map("serie_number")
  imeiNumber            String? @map("imei_number")
  codeTransactionDetail Int?    @map("code_transaction_detail")
  numberItem            Int?    @map("number_item")
  taxable               String?
  typeDetail            String? @map("type_detail")
  bill                  ebBill  @relation(fields: [billId], references: [billId])

  @@id([billId, order])
  @@map("eb_bill_detail")
}

model ebBillFile {
  billId    BigInt   @id @map("bill_id")
  xml       String
  createdAt DateTime @default(now()) @map("created_at")

  @@map("eb_bill_file")
}

model ebTransaction {
  transactionId     BigInt                 @id @default(autoincrement()) @map("transaction_id")
  referenceId       BigInt                 @map("reference_id")
  operation         String
  soapRequest       String?                @map("soap_request")
  soapResponse      String?                @map("soap_response")
  xml               String?
  receptionCode     String?                @map("recception_code")
  statusCode        String?                @map("status_code")
  statusDescription String?                @map("status_description")
  type              String
  cuf               String?
  user              String?
  createdAt         DateTime               @default(now()) @map("created_at")
  messages          ebTransactionMessage[]

  @@map("eb_transaction")
}

model ebTransactionMessage {
  transactionId BigInt        @map("transaction_id")
  order         Int
  receptionCode String        @map("recception_code")
  description   String        @map("description")
  billId        BigInt?       @map("bill_id")
  transaction   ebTransaction @relation(fields: [transactionId], references: [transactionId])

  @@id([transactionId, order])
  @@map("eb_transaction_message")
}

model ebSectorDocument {
  sectorCode      String @id @map("sector_code")
  description     String
  urlWsFe         String @map("url_ws")
  urlWsFec        String @map("url_ws_fec")
  xsdFe           Bytes? @map("xsd_fe")
  xsdFec          Bytes? @map("xsd_fec")
  methodFe        String @map("method_fe")
  methodFec       String @map("method_fec")
  serviceFe       String @map("service_fe")
  serviceFec      String @map("service_fec")
  documentTaxCode Int?   @map("document_tax_code")

  @@map("eb_sector_document")
}

model appCertificate {
  id              Int             @id @default(autoincrement())
  systemCode      String          @map("system_code")
  nit             BigInt
  certificate     Bytes?
  certificateType CertificateType @default(PRIMARY_KEY) @map("certificate_type")
  typeStorage     StorageType     @default(TEXT) @map("type_storage")
  status          Status          @default(ACTIVE)
  createdAt       DateTime        @default(now()) @map("created_at")
  expirationAt    DateTime        @map("expiration_at")
  idRef           Int?            @map("id_ref")

  @@map("app_certificate")
}

model ebEvent {
  eventId            Int       @id @default(autoincrement()) @map("event_id")
  eventType          Int       @map("event_type")
  systemCode         String    @map("system_code")
  nit                BigInt
  description        String
  sucursalCode       Int       @map("sucursal_code")
  salePointCode      Int       @map("sale_point_code")
  sectorDocumentCode String    @map("sector_document_code")
  beginAt            DateTime  @map("begin_at")
  endAt              DateTime? @map("end_at")
  cufdEvent          String    @map("cufd_event")
  eventStatusId      Int       @default(0) @map("event_status_id")
  recepcionCode      String?   @map("recepcion_code")
  cafc               String?
  selfManageable     String?   @map("self_manageable")

  @@map("eb_event")
}

model ebDosification {
  code               String @id
  sectorDocumentCode String @map("sector_document_code")
  begin              Int    @map("begin_")
  last               Int    @map("last_")
  current            Int    @map("current_")
  status             Status @default(ACTIVE)
  type               String @map("type_")
  systemCode         String @map("system_code")
  nit                BigInt
  modalityCode       Int    @default(0) @map("modality_code")

  @@map("eb_dosification")
}

model appLog {
  logId    BigInt   @id @default(autoincrement()) @map("log_id")
  service  String
  paramIn  String   @map("param_in")
  paramOut String   @map("param_out")
  dateTran DateTime @map("date_tran")
  tranId   BigInt   @map("tran_id")
  userId   Int      @map("user_Id")
  errorId  Int      @map("error_id")
  message  String
  ipClient String   @map("ip_client")

  @@map("app_log")
}

enum Status {
  ACTIVE
  INACTIVE
}

enum CertificateType {
  PRIMARY_KEY
  PUBLIC_KEY
}

enum StorageType {
  P12
  X509
  TEXT
}

enum DataType {
  NUMBER
  STRING
}
